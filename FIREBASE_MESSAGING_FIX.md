# ุฅุตูุงุญ ูุดุงูู Firebase Messaging

## ุงููุดุงูู ุงูุชู ุชู ุงูุชุดุงููุง:

### 1. ูุดููุฉ Content Security Policy (CSP) ๐ซ
```
Refused to connect to 'https://fcmregistrations.googleapis.com/v1/projects/mayor-plan/registrations'
```

**ุงูุญู ุงููุทุจู:**
- ุชู ุฅุถุงูุฉ `https://fcmregistrations.googleapis.com` ุฅูู CSP ูู `index.html`

### 2. ูุดููุฉ Firebase Messaging Token โ
```
ูุดู ูู ุฅุนุฏุงุฏ ุฅุดุนุงุฑุงุช ุงููุชุตูุญ: FirebaseError: Messaging: A problem occurred while subscribing the user to FCM
```

**ุงูุญู ุงููุทุจู:**
- ุชู ุฅุถุงูุฉ ูุนุงูุฌุฉ ุฃุฎุทุงุก ูุญุณูุฉ ูู `setupPushNotifications`
- ุงูุฅุดุนุงุฑุงุช ุงููุญููุฉ ุชุนูู ุญุชู ูู ูุดู Firebase Messaging

## ุงูุชุญุณููุงุช ุงููุทุจูุฉ:

### 1. ุฅุตูุงุญ Content Security Policy
```html
<!-- ูุจู ุงูุฅุตูุงุญ -->
connect-src 'self' https://firestore.googleapis.com https://identitytoolkit.googleapis.com https://securetoken.googleapis.com https://fcm.googleapis.com wss://s-usc1c-nss-0001.firebaseio.com

<!-- ุจุนุฏ ุงูุฅุตูุงุญ -->
connect-src 'self' https://firestore.googleapis.com https://identitytoolkit.googleapis.com https://securetoken.googleapis.com https://fcm.googleapis.com https://fcmregistrations.googleapis.com wss://s-usc1c-nss-0001.firebaseio.com
```

### 2. ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
```javascript
try {
  const token = await getToken(messaging, {
    vapidKey: import.meta.env.VITE_FCM_VAPID_KEY,
    serviceWorkerRegistration: registration
  });
} catch (tokenError) {
  console.warn('ูุดู ูู ุงูุญุตูู ุนูู ุชููู Firebase Messaging:', tokenError.message);
  console.log('ุณูุชู ุงุณุชุฎุฏุงู ุงูุฅุดุนุงุฑุงุช ุงููุญููุฉ ุจุฏูุงู ูู Firebase Messaging');
}
```

### 3. ุฅุถุงูุฉ ุฑุณุงุฆู ุชุดุฎูุต ููุตูุฉ
- `ุจุฏุก ุฅุนุฏุงุฏ ุฅุดุนุงุฑุงุช ุงููุชุตูุญ...`
- `ูุญุงููุฉ ุงูุญุตูู ุนูู ุชููู Firebase Messaging...`
- `ุชู ุงูุญุตูู ุนูู ุชููู Firebase Messaging: ...`
- `ูุดู ูู ุงูุญุตูู ุนูู ุชููู Firebase Messaging: ...`
- `ุณูุชู ุงุณุชุฎุฏุงู ุงูุฅุดุนุงุฑุงุช ุงููุญููุฉ ุจุฏูุงู ูู Firebase Messaging`

## ููููุฉ ุงูุงุฎุชุจุงุฑ:

### 1. ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช ุงููุญููุฉ
1. ุงุถุบุท ุนูู ุฒุฑ ุงูุฅุดุนุงุฑุงุช (๐)
2. ุงุถุบุท ุนูู "ุงุฎุชุจุงุฑ ุดุงุดุฉ ุงูููู"
3. ุชุญูู ูู ุธููุฑ ุงูุฅุดุนุงุฑ ุนูู ุดุงุดุฉ ุงูููู

### 2. ุงุฎุชุจุงุฑ ุฅูุดุงุก ููุนุฏ ุฌุฏูุฏ
1. ุงุฐูุจ ุฅูู ุฅูุดุงุก ููุนุฏ ุฌุฏูุฏ
2. ุฃูุดุฆ ููุนุฏ ุฌุฏูุฏ
3. ุชุญูู ูู ุธููุฑ ุงูุฅุดุนุงุฑ

### 3. ูุญุต ูุญุฏุฉ ุชุญูู ุงููุชุตูุญ
ุงุจุญุซ ุนู ูุฐู ุงูุฑุณุงุฆู:
```
โ ุจุฏุก ุฅุนุฏุงุฏ ุฅุดุนุงุฑุงุช ุงููุชุตูุญ...
โ Service Worker ready: [object ServiceWorkerRegistration]
โ ูุญุงููุฉ ุงูุญุตูู ุนูู ุชููู Firebase Messaging...
โ ุชู ุงูุญุตูู ุนูู ุชููู Firebase Messaging: ... (ุฅุฐุง ูุฌุญ)
โ๏ธ ูุดู ูู ุงูุญุตูู ุนูู ุชููู Firebase Messaging: ... (ุฅุฐุง ูุดู)
โ ุณูุชู ุงุณุชุฎุฏุงู ุงูุฅุดุนุงุฑุงุช ุงููุญููุฉ ุจุฏูุงู ูู Firebase Messaging
โ ุชู ุฅุนุฏุงุฏ ุงูุงุณุชูุงุน ููุฅุดุนุงุฑุงุช ุงููุงุฑุฏุฉ
โ ุชู ุชูุนูู ุฅุดุนุงุฑุงุช ุงููุชุตูุญ ุจูุฌุงุญ
```

## ุงููุชุงุฆุฌ ุงููุชููุนุฉ:

### 1. ุงูุฅุดุนุงุฑุงุช ุงููุญููุฉ โ
- ุชุนูู ุจุดูู ูุงูู ุญุชู ูู ูุดู Firebase Messaging
- ุชุธูุฑ ุนูู ุดุงุดุฉ ุงูููู
- ุชุนูู ูุน Service Worker

### 2. Firebase Messaging โ๏ธ
- ูุฏ ูุนูู ุฃู ูุง ูุนูู ุญุณุจ ุฅุนุฏุงุฏุงุช ุงูุฎุงุฏู
- ุฅุฐุง ูุดูุ ุงูุฅุดุนุงุฑุงุช ุงููุญููุฉ ุชุนูู ูุจุฏูู
- ูุง ูุคุซุฑ ุนูู ูุธุงุฆู ุงูุชุทุจูู ุงูุฃุณุงุณูุฉ

### 3. ุฑุณุงุฆู ุงูุชุดุฎูุต ๐
- ุฑุณุงุฆู ูุงุถุญุฉ ูู ูุญุฏุฉ ุงูุชุญูู
- ุชุญุฏูุฏ ุงููุดุงูู ุจุฏูุฉ
- ุฅุฑุดุงุฏุงุช ูุญู ุงููุดุงูู

## ููุงุญุธุงุช ูููุฉ:

### 1. ุงูุฅุดุนุงุฑุงุช ุงููุญููุฉ
- ุชุนูู ุจุฏูู Firebase Messaging
- ุชุณุชุฎุฏู Service Worker
- ุชุธูุฑ ุนูู ุดุงุดุฉ ุงูููู

### 2. Firebase Messaging
- ูุทููุจ ููุฅุดุนุงุฑุงุช ูู ุงูุฎุงุฏู
- ูุฏ ูุญุชุงุฌ ุฅุนุฏุงุฏุงุช ุฅุถุงููุฉ ูู Firebase Console
- ุงูุฅุดุนุงุฑุงุช ุงููุญููุฉ ุชุนูู ูุจุฏูู

### 3. ุงูุชุดุฎูุต
- ูุญุต ูุญุฏุฉ ุชุญูู ุงููุชุตูุญ
- ุงูุจุญุซ ุนู ุฑุณุงุฆู ุงูุฎุทุฃ
- ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช ุงููุญููุฉ

## ุฅุฐุง ุงุณุชูุฑุช ุงููุดุงูู:

1. **ุชุญูู ูู ูุญุฏุฉ ุชุญูู ุงููุชุตูุญ** ููุฃุฎุทุงุก ุงูุฌุฏูุฏุฉ
2. **ุฌุฑุจ ุฒุฑ "ุงุฎุชุจุงุฑ ุดุงุดุฉ ุงูููู"** ููุชุฃูุฏ ูู ุนูู ุงูุฅุดุนุงุฑุงุช ุงููุญููุฉ
3. **ุชุฃูุฏ ูู ููุญ ุฅุฐู ุงูุฅุดุนุงุฑุงุช** ูู ุงููุชุตูุญ
4. **ุฃุนุฏ ุชุญููู ุงูุตูุญุฉ** ุจุนุฏ ุงูุชุญุฏูุซุงุช

ุงูุฅุดุนุงุฑุงุช ุงููุญููุฉ ูุฌุจ ุฃู ุชุนูู ุงูุขู ุญุชู ูู ูุดู Firebase Messaging! ๐
