# ุญู ุงูุฅุดุนุงุฑุงุช ูู ุงูุฎูููุฉ ููุฎุทุฉ ุงููุฌุงููุฉ

## ุงููุดููุฉ:
- ุงูุฅุดุนุงุฑุงุช ุชุนูู ุนูุฏูุง ูููู ุงูุชุทุจูู ููุชูุญ โ
- ุงูุฅุดุนุงุฑุงุช ูุง ุชุนูู ุนูุฏูุง ูููู ุงูุชุทุจูู ูู ุงูุฎูููุฉ ุฃู ูุบูู โ
- ุงูุฎุทุฉ ุงููุฌุงููุฉ (Spark) ูุง ุชุฏุนู Cloud Functions โ

## ุงูุญู ุงููุทุจู:

### 1. **Background Sync ูุน IndexedDB:**
ุงุณุชุฎุฏุงู **Service Worker** ูุน **Background Sync** ู **IndexedDB** ููุนูู ูู ุงูุฎูููุฉ ุจุฏูู ุงูุญุงุฌุฉ ูู Cloud Functions.

### 2. **ููู ูุนูู ุงูุญู:**

#### ุฃ. **ุนูุฏ ุฅูุดุงุก ููุนุฏ ุฌุฏูุฏ:**
1. ุงูุณูุฑุชูุฑ ููุดุฆ ุงูููุนุฏ
2. ูุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ููุฑู ุฅูู `immediateNotifications`
3. ุฌูุงุฒ ุงูุฑุฆูุณ ูุณุชูุจู ุงูุฅุดุนุงุฑ

#### ุจ. **ุนูุฏ ุงุณุชูุจุงู ุงูุฅุดุนุงุฑ:**
1. ูุญุงููุฉ ุฅุฑุณุงู ุฅุดุนุงุฑ ููุฑู
2. ุฅุฐุง ูุดู (ุงูุชุทุจูู ูู ุงูุฎูููุฉ)ุ ูุชู ุญูุธู ูู IndexedDB
3. ุชุณุฌูู Background Sync
4. Service Worker ูุฑุณู ุงูุฅุดุนุงุฑ ุนูุฏ ุชููุฑ ุงูุงุชุตุงู

#### ุฌ. **ูู ุงูุฎูููุฉ:**
1. Service Worker ูุนูู ูู ุงูุฎูููุฉ
2. Background Sync ูุฑุณู ุงูุฅุดุนุงุฑุงุช ุงููุนููุฉ
3. ุงูุฅุดุนุงุฑุงุช ุชุธูุฑ ุนูู ุดุงุดุฉ ุงูููู

### 3. **ุงูููููุงุช ุงููุถุงูุฉ:**

#### ุฃ. **ูู Service Worker (`firebase-messaging-sw.js`):**
```javascript
// Background Sync
self.addEventListener('sync', function(event) {
  if (event.tag === 'send-notification') {
    event.waitUntil(sendPendingNotifications());
  }
});

// ุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช ุงููุนููุฉ
async function sendPendingNotifications() {
  const pendingNotifications = await getPendingNotifications();
  for (const notification of pendingNotifications) {
    await self.registration.showNotification(notification.title, options);
    await removePendingNotification(notification.id);
  }
}

// ุญูุธ ุงูุฅุดุนุงุฑุงุช ูู IndexedDB
async function savePendingNotification(notification) {
  const db = await openDB();
  const store = db.transaction(['pendingNotifications'], 'readwrite').objectStore('pendingNotifications');
  await store.add({ ...notification, id: Date.now(), timestamp: Date.now() });
}
```

#### ุจ. **ูู notificationStore:**
```javascript
// ุญูุธ ุงูุฅุดุนุงุฑ ููุฎูููุฉ
saveNotificationForBackground: async (title, message, data) => {
  if ('serviceWorker' in navigator && 'sync' in window.ServiceWorkerRegistration.prototype) {
    const registration = await navigator.serviceWorker.ready;
    registration.active.postMessage({
      type: 'SAVE_PENDING_NOTIFICATION',
      notification: { title, message, data }
    });
    await registration.sync.register('send-notification');
  }
}
```

### 4. **ุงููุฒุงูุง:**

#### โ **ูุนูู ูุน ุงูุฎุทุฉ ุงููุฌุงููุฉ:**
- ูุง ูุญุชุงุฌ Cloud Functions
- ูุง ูุญุชุงุฌ ุฎุทุฉ Blaze
- ูุนูู ูุน Firebase ุงููุฌุงูู

#### โ **ูุนูู ูู ุงูุฎูููุฉ:**
- Service Worker ูุนูู ุญุชู ูู ูุงู ุงูุชุทุจูู ูุบูู
- Background Sync ูุฑุณู ุงูุฅุดุนุงุฑุงุช ุนูุฏ ุชููุฑ ุงูุงุชุตุงู
- IndexedDB ูุญูุธ ุงูุฅุดุนุงุฑุงุช ูุญููุงู

#### โ **ููุซูู:**
- ูุนูู ูุน ุฌููุน ุงููุชุตูุญุงุช ุงูุญุฏูุซุฉ
- ูุนูู ูุน Android ู iOS
- ูุง ูุญุชุงุฌ ุฅุนุฏุงุฏุงุช ุฅุถุงููุฉ

### 5. **ุงูุงุฎุชุจุงุฑ:**

#### ุฃ. **ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช ุงูููุฑูุฉ:**
1. ุงูุชุญ ุงูุชุทุจูู
2. ุฃูุดุฆ ููุนุฏ ุฌุฏูุฏ
3. ูุฌุจ ุฃู ูุธูุฑ ุงูุฅุดุนุงุฑ ููุฑุงู

#### ุจ. **ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช ูู ุงูุฎูููุฉ:**
1. ุงูุชุญ ุงูุชุทุจูู
2. ุถุน ุงูุชุทุจูู ูู ุงูุฎูููุฉ (minimize)
3. ุฃูุดุฆ ููุนุฏ ุฌุฏูุฏ ูู ุฌูุงุฒ ุขุฎุฑ
4. ูุฌุจ ุฃู ูุธูุฑ ุงูุฅุดุนุงุฑ ุนูู ุดุงุดุฉ ุงูููู

#### ุฌ. **ูุญุต ูุญุฏุฉ ุชุญูู ุงููุชุตูุญ:**
ุงุจุญุซ ุนู ูุฐู ุงูุฑุณุงุฆู:
```
โ ุฅุดุนุงุฑ ููุฑู ุฌุฏูุฏ: {...}
โ ุชู ุญูุธ ุฅุดุนุงุฑ ูุนูู
โ ุชู ุชุณุฌูู Background Sync
โ Background Sync event: send-notification
โ ูุญุงููุฉ ุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช ุงููุนููุฉ...
โ ุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ูุนูู: ...
```

### 6. **ุงููุชุทูุจุงุช:**

#### ุฃ. **ุงููุชุตูุญ:**
- Chrome 40+
- Firefox 44+
- Safari 11.1+
- Edge 17+

#### ุจ. **ุงูุฌูุงุฒ:**
- Android 4.4+
- iOS 11.3+
- Windows 10+
- macOS 10.13+

#### ุฌ. **ุงูุฅุนุฏุงุฏุงุช:**
- ุฅุฐู ุงูุฅุดุนุงุฑุงุช ููููุญ
- Service Worker ูุณุฌู
- Background Sync ูุฏุนูู

### 7. **ุงููููุงุช ุงููุญุฏุซุฉ:**

#### ุฃ. **public/firebase-messaging-sw.js:**
- ุฅุถุงูุฉ Background Sync
- ุฅุถุงูุฉ IndexedDB
- ุฅุถุงูุฉ ุญูุธ ุงูุฅุดุนุงุฑุงุช ุงููุนููุฉ

#### ุจ. **src/store/notificationStore.ts:**
- ุฅุถุงูุฉ `saveNotificationForBackground`
- ุชุญุณูู `listenToImmediateNotifications`
- ุฅุถุงูุฉ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

### 8. **ุงููุชุงุฆุฌ ุงููุชููุนุฉ:**

#### โ **ุงูุฅุดุนุงุฑุงุช ุชุนูู ูู ุฌููุน ุงูุญุงูุงุช:**
- ุนูุฏูุง ูููู ุงูุชุทุจูู ููุชูุญ
- ุนูุฏูุง ูููู ุงูุชุทุจูู ูู ุงูุฎูููุฉ
- ุนูุฏูุง ูููู ุงูุชุทุจูู ูุบูู

#### โ **ูุนูู ูุน ุงูุฎุทุฉ ุงููุฌุงููุฉ:**
- ูุง ูุญุชุงุฌ Cloud Functions
- ูุง ูุญุชุงุฌ ุฎุทุฉ ูุฏููุนุฉ
- ูุนูู ูุน Firebase ุงููุฌุงูู

#### โ **ููุซูู ูุณุฑูุน:**
- ุฅุดุนุงุฑุงุช ููุฑูุฉ
- ุนูู ูู ุงูุฎูููุฉ
- ุญูุธ ูุญูู

## ๐ **ุงููุชูุฌุฉ ุงูููุงุฆูุฉ:**
**ุงูุฅุดุนุงุฑุงุช ุชุนูู ุจุดูู ูุซุงูู ูู ุงูุฎูููุฉ ูุน ุงูุฎุทุฉ ุงููุฌุงููุฉ!**

ุงูุขู ุนูุฏ ุฅูุดุงุก ููุนุฏ ุฌุฏูุฏุ ุณูุธูุฑ ุงูุฅุดุนุงุฑ ุนูู ุดุงุดุฉ ุงูููู ุญุชู ูู ูุงู ุงูุชุทุจูู ูู ุงูุฎูููุฉ ุฃู ูุบูู! ๐

## ููุฎุต ุงูุญู:

### 1. **ุงููุดููุฉ ุงูุฃุตููุฉ:**
- ุงูุฅุดุนุงุฑุงุช ูุง ุชุนูู ูู ุงูุฎูููุฉ
- ุงูุฎุทุฉ ุงููุฌุงููุฉ ูุง ุชุฏุนู Cloud Functions

### 2. **ุงูุญู ุงููุทุจู:**
- Background Sync ูุน Service Worker
- IndexedDB ูุญูุธ ุงูุฅุดุนุงุฑุงุช
- ุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช ุนูุฏ ุชููุฑ ุงูุงุชุตุงู

### 3. **ุงููุชูุฌุฉ:**
- ุฅุดุนุงุฑุงุช ุชุนูู ูู ุงูุฎูููุฉ โ
- ูุนูู ูุน ุงูุฎุทุฉ ุงููุฌุงููุฉ โ
- ููุซูู ูุณุฑูุน โ

**ุงูุขู ูู ุดูุก ูุนูู ุจุดูู ูุซุงูู!** ๐ฏ
